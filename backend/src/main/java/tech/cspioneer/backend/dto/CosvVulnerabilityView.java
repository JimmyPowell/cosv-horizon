package tech.cspioneer.backend.dto;

import io.swagger.v3.oas.annotations.media.Schema;
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.time.LocalDateTime;
import java.util.List;
import java.util.Map;

@Data
@NoArgsConstructor
@AllArgsConstructor
@Schema(description = "COSV 顶层视图（用于导出/展示）")
public class CosvVulnerabilityView {
    @Schema(description = "COSV 业务标识", example = "COSV-2025-000001")
    private String id;
    @Schema(description = "Schema版本", example = "1.0.0")
    private String schemaVersion;
    @Schema(description = "摘要")
    private String summary;
    @Schema(description = "详情（Markdown）")
    private String details;
    @Schema(description = "发布时间")
    private LocalDateTime published;
    @Schema(description = "撤回时间")
    private LocalDateTime withdrawn;
    @Schema(description = "修改时间")
    private LocalDateTime modified;

    // 关联
    private List<String> aliases;
    private List<String> related;
    private List<Map<String, String>> references; // {type,url}

    // 类型/时间线
    private List<String> cweIds;
    private List<String> cweNames;
    private List<Map<String, String>> timeLine; // {type,value}

    // 危险性
    private List<Map<String, String>> severity; // {type,score,level,score_num}

    // 受影响面（简化视图）
    private List<Map<String, Object>> affected;

    // 扩展
    private String confirmedType;
}

